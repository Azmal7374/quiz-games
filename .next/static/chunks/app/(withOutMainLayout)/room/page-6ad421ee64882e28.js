(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[423],{5099:(e,t,s)=>{Promise.resolve().then(s.bind(s,44838))},44838:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var r=s(95155),i=s(12115),a=s(76046),n=s(82651),l=s(51614),o=s(33084),c=s(71319);let d=(0,c.io)("https://trivia-web-server-production.up.railway.app/"),u=e=>{let{userName:t,roomId:s}=e,[a,n]=(0,i.useState)(""),[l,o]=(0,i.useState)([]),[c,u]=(0,i.useState)("");(0,i.useEffect)(()=>{if(!t||!s)return;let e=new Date().toLocaleTimeString();u(e),d.emit("joinRoom",{userName:t,roomCode:s});let r=!1,i=!1;return d.on("userJoined",t=>{let{userName:s,action:i}=t;if(!r){let t="".concat(s," ").concat(i," the room.");o(s=>[...s,{user:"System",text:t,time:e}]),r=!0}}),d.on("userLeft",t=>{let{userName:s,action:r}=t;if(!i){let t="".concat(s," ").concat(r," the room.");o(s=>[...s,{user:"System",text:t,time:e}]),i=!0}}),d.on("newMessage",s=>{s.user!==t&&o(t=>[...t,{...s,time:e}])}),()=>{d.emit("leaveRoom",{roomCode:s,userName:t}),d.off("userJoined"),d.off("userLeft"),d.off("newMessage")}},[s,t]);let m=()=>{if(!a.trim())return;let e={user:t,text:a,roomId:s,time:new Date().toLocaleTimeString()};d.emit("chatMessage",e),o(t=>[...t,e]),n("")};return(0,r.jsxs)("div",{className:"w-full bg-white  rounded-lg space-y-4",children:[(0,r.jsx)("div",{className:"h-64 overflow-y-auto p-4  rounded-md border border-gray-300 shadow-inner space-y-3",children:l.map((e,s)=>(0,r.jsx)("div",{className:"flex ".concat(e.user===t?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:"max-w-xs p-2 rounded-lg ".concat(e.user===t?"bg-green-600 text-white":"bg-gray-200 text-black"),children:[(0,r.jsx)("strong",{children:e.user}),": ",e.text,(0,r.jsx)("span",{className:"block text-xs ",children:e.time})]})},s))}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("input",{className:"w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Type your message...",type:"text",value:a,onChange:e=>n(e.target.value),onKeyDown:e=>{"Enter"===e.key&&m()}}),(0,r.jsx)("button",{className:"bg-green-500 text-white p-2 rounded-lg hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500",onClick:m,children:"Send"})]})]})};var m=s(53693),x=s(30814),h=s(11536);let v=(0,c.Ay)("https://trivia-web-server-production.up.railway.app/"),g=()=>{var e,t;let s=(0,a.useSearchParams)(),c=(0,a.useRouter)(),[d,g]=(0,i.useState)(""),f=s.get("roomId"),[p,j]=(0,i.useState)(null),[w,b]=(0,i.useState)(""),[y,N]=(0,i.useState)(!0),[S,q]=(0,i.useState)(!1),[C,E]=(0,i.useState)(""),[k,L]=(0,i.useState)(!1),[R,z]=(0,i.useState)(!1),[A,I]=(0,i.useState)([]),[Q,T]=(0,i.useState)(0),[U,_]=(0,i.useState)(0),[D,P]=(0,i.useState)(null),[M,W]=(0,i.useState)([]),[B,J]=(0,i.useState)(0),[O,F]=(0,i.useState)(!1);(0,i.useEffect)(()=>{f&&d&&v.emit("joinRoom",{roomCode:f,userName:d})},[f,d]),(0,i.useEffect)(()=>{g(new URLSearchParams(window.location.search).get("username"))},[]),(0,i.useEffect)(()=>{f&&n.A.get("https://trivia-web-server-production.up.railway.app/api/room/".concat(f)).then(e=>{j(e.data),N(!1),_(e.data.timer||0)}).catch(()=>{b("Failed to load room data."),c.push("/"),N(!1)})},[f]),(0,i.useEffect)(()=>{if(S&&(null==p?void 0:p.questions)){var e,t;_(p.timer||(null===(e=p.questions[Q])||void 0===e?void 0:e.timeLimit)),K(p.timer||(null===(t=p.questions[Q])||void 0===t?void 0:t.timeLimit))}},[S,p,Q]),(0,i.useEffect)(()=>{0===U&&S&&!k&&G()},[U]),(0,i.useEffect)(()=>(v.on("startQuiz",()=>{var e;q(!0),L(!1),T(0),W([]),J(0),F(!1),K((null==p?void 0:p.timer)||(null==p?void 0:null===(e=p.questions[0])||void 0===e?void 0:e.timeLimit))}),()=>{v.off("startQuiz")}),[p]),(0,i.useEffect)(()=>(v.on("updateUserAnswers",e=>{I(e)}),()=>{v.off("updateUserAnswers")}),[]);let K=e=>{D&&clearInterval(D),_(e);let t=setInterval(()=>{_(e=>e<=1?(clearInterval(t),0):e-1)},1e3);P(t)},X=e=>{var t;let s=e===(null==p?void 0:null===(t=p.questions[Q])||void 0===t?void 0:t.correctAnswer);W(t=>[...t,{questionIndex:Q,answer:e,correct:s}]);let r=s?B+1:B;J(r),F(!0),v.emit("submitAnswer",{roomId:f,username:d,correctAnswersCount:r})},G=()=>{if(Q<(null==p?void 0:p.questions.length)-1){var e;T(Q+1),F(!1),K(null==p?void 0:null===(e=p.questions[Q+1])||void 0===e?void 0:e.timeLimit)}else v.emit("endQuiz",f),L(!0)};return((0,i.useEffect)(()=>(v.on("updateUserAnswers",e=>{I(e)}),()=>{v.off("updateUserAnswers")}),[]),y)?(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,r.jsx)(m.A,{})}):w?(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,r.jsx)("p",{className:"text-xl text-red-500",children:w})}):(0,r.jsxs)("div",{className:"px-6 py-8 max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start gap-6 flex-wrap mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-3xl font-semibold text-gray-800",children:["Quiz Room: ",f]}),(0,r.jsxs)("h2",{className:"text-xl font-semibold text-gray-600",children:["Welcome, ",d||"Player","!"]})]}),(0,r.jsx)("div",{className:"flex flex-col items-center",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)(o.X,{id:"qrcode-canvas",value:"https://brain-bitz-quiz-game.vercel.app/room?roomId=".concat(f),size:120}),(0,r.jsx)("button",{onClick:()=>{let e=document.getElementById("qrcode-canvas");if(e){let t=e.toDataURL("image/png");E(t);let s=document.createElement("a");s.href=t,s.download="room-".concat(f,"-qr.png"),s.click()}else x.oR.error("QR code canvas not found",{duration:5e3,icon:"⚠️"})},className:"mt-2  py-2 rounded ",children:(0,r.jsx)(h.WCW,{})})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Current Users:"}),(0,r.jsx)("ul",{className:"list-disc ml-6 space-y-1",children:null==p?void 0:p.users.map((e,t)=>(0,r.jsx)("li",{className:"text-sm text-gray-700",children:e.username},t))})]})]}),(0,r.jsxs)("div",{className:"w-full bg-white rounded-lg p-6 border-2 h-[450px] md:h-[420px]",children:[!S&&(0,r.jsx)(l.T,{onClick:()=>{!S&&f&&v.emit("startQuiz",{roomId:f})},className:"w-40 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition duration-300",children:"Start Quiz"}),S&&!k&&(null==p?void 0:p.questions)&&p.questions.length>0&&(0,r.jsxs)("div",{className:"",children:[(0,r.jsxs)("p",{className:"mt-2 text-center text-lg font-medium",children:["Time Left: ",U," s"]}),(0,r.jsxs)("h3",{className:"text-lg font-semibold mt-4",children:["Question ",Q+1,":"," ",null===(e=p.questions[Q])||void 0===e?void 0:e.question]}),(0,r.jsx)("div",{className:"mt-4 grid gap-4 ",children:null===(t=p.questions[Q])||void 0===t?void 0:t.options.map((e,t)=>(0,r.jsx)(l.T,{className:"w-full py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition duration-200",onClick:()=>X(e),children:e},t))}),(0,r.jsx)("div",{className:"mt-4 text-center",children:(0,r.jsx)(l.T,{onClick:()=>G(),disabled:!O,className:"w-40 py-2 ".concat(O?"bg-green-500 hover:bg-green-600":"bg-gray-400 cursor-not-allowed"," text-white rounded-lg transition duration-300"),children:"Lock In"})})]}),k&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-2xl text-center font-bold text-green-600",children:"Quiz Ended!"}),(0,r.jsx)("h4",{className:"text-lg font-semibold",children:"Real-Time Scores:"}),null==p?void 0:p.users.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm text-gray-700",children:[e.username,": ",B," correct answers"]},t)),(0,r.jsx)(l.T,{onClick:()=>{var e;q(!1),L(!1),T(0),W([]),J(0),F(!1),z(!1),_((null==p?void 0:p.timer)||0),D&&clearInterval(D),v.emit("resetQuiz",{roomId:f}),q(!0),T(0),F(!1),z(!1);let t=(null==p?void 0:p.timer)||(null==p?void 0:null===(e=p.questions[Q])||void 0===e?void 0:e.timeLimit);_(t),K(t)},className:"w-40 bg-green-500 text-white rounded-lg hover:bg-green-600 transition duration-300",children:"Reset Room"})]})]}),(0,r.jsx)("div",{className:"py-10",children:(0,r.jsx)(u,{userName:d||"",roomId:f})})]})}},53693:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(95155),i=s(30277);s(72928);let a=()=>(0,r.jsx)("div",{className:"pos-center",children:(0,r.jsx)(i.uB,{visible:!0,height:"100",width:"100",ariaLabel:"dna-loading",wrapperStyle:{},wrapperClass:"dna-wrapper"})})},72928:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[433,711,134,524,614,814,238,285,444,441,517,358],()=>t(5099)),_N_E=e.O()}]);